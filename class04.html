<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<title>Class04</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=1274, user-scalable=no">
	<meta name="description" content="Class04">
	<meta name="author" content="Yu-Ru Lin">
	<meta name="generator" content="slidify" />
	<!-- LOAD STYLE SHEETS -->
	<link rel="stylesheet" href="libraries/frameworks/shower/themes/ribbon/styles/screen.css">
	<link rel="stylesheet" media="print"
	  href="libraries/frameworks/shower/themes/ribbon/styles/print.css">
	<link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css">  <link rel="stylesheet" href = "assets/css/mystyle.css">
<link rel="stylesheet" href = "assets/css/ribbons.css">

	<!--
		To apply styles to the certain slides
		use slide ID to get needed elements
		-->
	<style>
		#Cover h2 {
      margin:65px 0 0;
			color:#FFF;
			text-align:center;
			font-size:70px;
			}
		#FitToWidth h2,
		#FitToHeight h2 {
			color:#FFF;
			text-align:center;
			}
	</style> 
</head>
<body class="list">
  <header class="caption">
  	<h1>Class04</h1>
	</header>
  <section class="slide " id="toc">
  <div>
    <h2>NA</h2>
    <ul>
<li><a href="#set-up">Set up</a></li>
<li><a href="#nb">Naive Bayesian</a></li>
<li><a href="#tree">Decision Trees</a></li>
</ul>

  </div>
</section>
<section class="slide modal" id="set-up">
  <div>
    <h2>Install R packages</h2>
    <pre><code class="r">## this tutorial uses the following packages
</code></pre>

  </div>
</section>
<section class="slide modal" id="nb">
  <div>
    <h2>Naive Bayesian</h2>
    <p>The examples are taken from <a href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-111844714X.html">Data Mining and Business Analytics with R</a> and <a href="http://shop.oreilly.com/product/0636920018483.do">Machine Learning for Hackers</a>.</p>

<h2>Example: Delayed Flights</h2>

<ul>
<li>response variable: whether or not a flight has been delayed by more than 15 min (coded as 0 for no delay, and 1 for delay)</li>
<li>explanatory variables: different arrival airports, different departure airports, eight carriers, different hours of departure (6am to 10 pm), weather conditions (0 = good/1 = bad), day of week (1 for Sunday and Monday; and 0 for all other days)</li>
<li>objective: to identify flights that are likely to be delayed (a binary classification problem)</li>
</ul>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-4">
  <div>
    <h2>Naive Bayesian</h2>
    <pre><code class="r">set.seed(1)
library(car)  #used to recode a variable

## reading the data
data.url = &#39;http://www.yurulin.com/class/spring2014_datamining/data/data_text&#39;
delay = read.csv(sprintf(&quot;%s/FlightDelays.csv&quot;,data.url))
delay[1:3,]
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-5">
  <div>
    <h2>Naive Bayesian</h2>
    <pre><code class="r">del=data.frame(delay)
</code></pre>

<pre><code>## Error in data.frame(delay): object &#39;delay&#39; not found
</code></pre>

<pre><code class="r">del$schedf=factor(floor(del$schedtime/100))
</code></pre>

<pre><code>## Error in `$&lt;-.data.frame`(`*tmp*`, schedf, value = structure(integer(0), .Label = character(0), class = &quot;factor&quot;)): replacement has 0 rows, data has 2201
</code></pre>

<pre><code class="r">del$delay=recode(del$delay,&quot;&#39;delayed&#39;=1;else=0&quot;)
response=as.numeric(levels(del$delay)[del$delay])
hist(response)
</code></pre>

<pre><code>## Error in hist.default(response): invalid number of &#39;breaks&#39;
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-6">
  <div>
    <h2>Naive Bayesian</h2>
    <pre><code class="r">## determining test and evaluation data sets
n=length(del$dayweek)
n
</code></pre>

<pre><code>## [1] 2201
</code></pre>

<pre><code class="r">n1=floor(n*(0.6)) ## 60% for training
n1 # num of training cases
</code></pre>

<pre><code>## [1] 1320
</code></pre>

<pre><code class="r">n2=n-n1
n2 # num of testing cases
</code></pre>

<pre><code>## [1] 881
</code></pre>

<pre><code class="r">train=sample(1:n,n1)

## determining marginal probabilities
tttt=cbind(del$schedf[train],del$carrier[train],del$dest[train],del$origin[train],del$weather[train],del$dayweek[train],response[train])
tttrain0=tttt[tttt[,7]&lt;0.5,]
</code></pre>

<pre><code>## Error in tttt[, 7]: subscript out of bounds
</code></pre>

<pre><code class="r">tttrain1=tttt[tttt[,7]&gt;0.5,]
</code></pre>

<pre><code>## Error in tttt[, 7]: subscript out of bounds
</code></pre>

<pre><code class="r">## prior probabilities
tdel=table(response[train])
tdel=tdel/sum(tdel)
tdel
</code></pre>

<pre><code>## numeric(0)
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-7">
  <div>
    <h2>Naive Bayesian</h2>
    <pre><code class="r">## scheduled time
ts0=table(tttrain0[,1])
</code></pre>

<pre><code>## Error in table(tttrain0[, 1]): object &#39;tttrain0&#39; not found
</code></pre>

<pre><code class="r">ts0=ts0/sum(ts0)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;ts0&#39; not found
</code></pre>

<pre><code class="r">ts0
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;ts0&#39; not found
</code></pre>

<pre><code class="r">ts1=table(tttrain1[,1])
</code></pre>

<pre><code>## Error in table(tttrain1[, 1]): object &#39;tttrain1&#39; not found
</code></pre>

<pre><code class="r">ts1=ts1/sum(ts1)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;ts1&#39; not found
</code></pre>

<pre><code class="r">ts1
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;ts1&#39; not found
</code></pre>

<pre><code class="r">## scheduled carrier
tc0=table(tttrain0[,2])
</code></pre>

<pre><code>## Error in table(tttrain0[, 2]): object &#39;tttrain0&#39; not found
</code></pre>

<pre><code class="r">tc0=tc0/sum(tc0)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tc0&#39; not found
</code></pre>

<pre><code class="r">tc0
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tc0&#39; not found
</code></pre>

<pre><code class="r">tc1=table(tttrain1[,2])
</code></pre>

<pre><code>## Error in table(tttrain1[, 2]): object &#39;tttrain1&#39; not found
</code></pre>

<pre><code class="r">tc1=tc1/sum(tc1)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tc1&#39; not found
</code></pre>

<pre><code class="r">tc1
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tc1&#39; not found
</code></pre>

<pre><code class="r">## scheduled destination
td0=table(tttrain0[,3])
</code></pre>

<pre><code>## Error in table(tttrain0[, 3]): object &#39;tttrain0&#39; not found
</code></pre>

<pre><code class="r">td0=td0/sum(td0)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;td0&#39; not found
</code></pre>

<pre><code class="r">td0
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;td0&#39; not found
</code></pre>

<pre><code class="r">td1=table(tttrain1[,3])
</code></pre>

<pre><code>## Error in table(tttrain1[, 3]): object &#39;tttrain1&#39; not found
</code></pre>

<pre><code class="r">td1=td1/sum(td1)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;td1&#39; not found
</code></pre>

<pre><code class="r">td1
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;td1&#39; not found
</code></pre>

<pre><code class="r">## scheduled origin  
to0=table(tttrain0[,4])
</code></pre>

<pre><code>## Error in table(tttrain0[, 4]): object &#39;tttrain0&#39; not found
</code></pre>

<pre><code class="r">to0=to0/sum(to0)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;to0&#39; not found
</code></pre>

<pre><code class="r">to0
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;to0&#39; not found
</code></pre>

<pre><code class="r">to1=table(tttrain1[,4])
</code></pre>

<pre><code>## Error in table(tttrain1[, 4]): object &#39;tttrain1&#39; not found
</code></pre>

<pre><code class="r">to1=to1/sum(to1)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;to1&#39; not found
</code></pre>

<pre><code class="r">to1
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;to1&#39; not found
</code></pre>

<pre><code class="r">## weather
tw0=table(tttrain0[,5])
</code></pre>

<pre><code>## Error in table(tttrain0[, 5]): object &#39;tttrain0&#39; not found
</code></pre>

<pre><code class="r">tw0=tw0/sum(tw0)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tw0&#39; not found
</code></pre>

<pre><code class="r">tw0
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tw0&#39; not found
</code></pre>

<pre><code class="r">tw1=table(tttrain1[,5])
</code></pre>

<pre><code>## Error in table(tttrain1[, 5]): object &#39;tttrain1&#39; not found
</code></pre>

<pre><code class="r">tw1=tw1/sum(tw1)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tw1&#39; not found
</code></pre>

<pre><code class="r">tw1
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tw1&#39; not found
</code></pre>

<pre><code class="r">## bandaid as no observation in a cell
tw0=tw1
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tw1&#39; not found
</code></pre>

<pre><code class="r">tw0[1]=1
</code></pre>

<pre><code>## Error in tw0[1] = 1: object &#39;tw0&#39; not found
</code></pre>

<pre><code class="r">tw0[2]=0
</code></pre>

<pre><code>## Error in tw0[2] = 0: object &#39;tw0&#39; not found
</code></pre>

<pre><code class="r">## scheduled day of week
tdw0=table(tttrain0[,6])
</code></pre>

<pre><code>## Error in table(tttrain0[, 6]): object &#39;tttrain0&#39; not found
</code></pre>

<pre><code class="r">tdw0=tdw0/sum(tdw0)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tdw0&#39; not found
</code></pre>

<pre><code class="r">tdw0
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tdw0&#39; not found
</code></pre>

<pre><code class="r">tdw1=table(tttrain1[,6])
</code></pre>

<pre><code>## Error in table(tttrain1[, 6]): object &#39;tttrain1&#39; not found
</code></pre>

<pre><code class="r">tdw1=tdw1/sum(tdw1)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tdw1&#39; not found
</code></pre>

<pre><code class="r">tdw1
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;tdw1&#39; not found
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-8">
  <div>
    <h2>Naive Bayesian</h2>
    <pre><code class="r">## creating test data set
tt=cbind(del$schedf[-train],del$carrier[-train],del$dest[-train],del$origin[-train],del$weather[-train],del$dayweek[-train],response[-train])

## creating predictions, stored in gg
p0=ts0[tt[,1]]*tc0[tt[,2]]*td0[tt[,3]]*to0[tt[,4]]*tw0[tt[,5]+1]*tdw0[tt[,6]]
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;ts0&#39; not found
</code></pre>

<pre><code class="r">p1=ts1[tt[,1]]*tc1[tt[,2]]*td1[tt[,3]]*to1[tt[,4]]*tw1[tt[,5]+1]*tdw1[tt[,6]]
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;ts1&#39; not found
</code></pre>

<pre><code class="r">gg=(p1*tdel[2])/(p1*tdel[2]+p0*tdel[1])
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;p1&#39; not found
</code></pre>

<pre><code class="r">hist(gg)
</code></pre>

<pre><code>## Error in hist(gg): object &#39;gg&#39; not found
</code></pre>

<pre><code class="r">## coding as 1 if probability 0.5 or larger
gg1=floor(gg+0.5)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;gg&#39; not found
</code></pre>

<pre><code class="r">ttt=table(response[-train],gg1)
</code></pre>

<pre><code>## Error in table(response[-train], gg1): all arguments must have the same length
</code></pre>

<pre><code class="r">ttt
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;ttt&#39; not found
</code></pre>

<pre><code class="r">error=(ttt[1,2]+ttt[2,1])/n2
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;ttt&#39; not found
</code></pre>

<pre><code class="r">error
</code></pre>

<pre><code>## [1] 0.1782066
</code></pre>

  </div>
</section>
  <div class="progress">
    <div></div>
  </div>
    <footer class = 'foot'>
      <a href="index.html"><img src = 'assets/img/arrow_up_circle.png' style="width:30px;height:30px;"></a></img>
      <a href="#toc"><img src = 'assets/img/circle-info.png' style="width:32px;height:32px;"></a></img>
    </footer>    
	<script src="libraries/frameworks/shower/shower.js"></script>
	<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
	<script type="text/x-mathjax-config">
	  MathJax.Hub.Config({
	    tex2jax: {
	      inlineMath: [['$','$'], ['\\(','\\)']],
	      processEscapes: true
	    }
	  });
	</script>
	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	<!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script> -->
	<script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
	<script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	<!-- DONE LOADING HIGHLIGHTER JS FILES -->
	 
		<!-- Copyright © 2010–2012 Vadim Makeev — pepelsbey.net -->
	<!-- Photos by John Carey — fiftyfootshadows.net -->
</body>
</html>