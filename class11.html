<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<title>Class11</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=1274, user-scalable=no">
	<meta name="description" content="Class11">
	<meta name="author" content="Yu-Ru Lin">
	<meta name="generator" content="slidify" />
	<!-- LOAD STYLE SHEETS -->
	<link rel="stylesheet" href="libraries/frameworks/shower/themes/ribbon/styles/screen.css">
	<link rel="stylesheet" media="print"
	  href="libraries/frameworks/shower/themes/ribbon/styles/print.css">
	<link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css">  <link rel="stylesheet" href = "assets/css/mystyle.css">
<link rel="stylesheet" href = "assets/css/ribbons.css">

	<!--
		To apply styles to the certain slides
		use slide ID to get needed elements
		-->
	<style>
		#Cover h2 {
      margin:65px 0 0;
			color:#FFF;
			text-align:center;
			font-size:70px;
			}
		#FitToWidth h2,
		#FitToHeight h2 {
			color:#FFF;
			text-align:center;
			}
	</style> 
</head>
<body class="list">
  <header class="caption">
  	<h1>Class11</h1>
	</header>
  <section class="slide " id="toc">
  <div>
    <h2>Class11</h2>
    <ul>
<li><a href="#set-up">Set up</a></li>
<li><a href="#data">Data manipulation</a></li>
<li><a href="#sample">Sample dataset</a></li>
<li><a href="#recommender">Recommender System</a></li>
</ul>

  </div>
</section>
<section class="slide modal" id="set-up">
  <div>
    <h2>Install R packages</h2>
    <pre><code class="r">## this tutorial uses the following packages
install.packages(&#39;recommenderlab&#39;)
</code></pre>

  </div>
</section>
<section class="slide compact" id="slide-3">
  <div>
    <h2>Recommendation</h2>
    <ul>
<li>The sample code is based on the examples given in <a href="http://cran.r-project.org/web/packages/recommenderlab/vignettes/recommenderlab.pdf">http://cran.r-project.org/web/packages/recommenderlab/vignettes/recommenderlab.pdf</a></li>
<li>See information about the installation and more details about what the package can do in the manual.</li>
</ul>

<pre><code class="r">library(recommenderlab)
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="data">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">## create a toy reating matrix
m = matrix(sample(c(as.numeric(0:5), NA), 50,
                  replace=TRUE, prob=c(rep(.4/6,6),.6)), ncol=10,
           dimnames=list(user=paste(&quot;u&quot;, 1:5, sep=&#39;&#39;),
                         item=paste(&quot;i&quot;, 1:10, sep=&#39;&#39;)))
m
</code></pre>

<pre><code>##     item
## user i1 i2 i3 i4 i5 i6 i7 i8 i9 i10
##   u1 NA NA NA  3 NA NA NA NA  1  NA
##   u2 NA NA NA NA NA NA NA  3 NA   4
##   u3  3  3 NA NA  4  0  3  4 NA   4
##   u4  1 NA NA NA  5 NA  1 NA NA  NA
##   u5 NA NA NA NA NA NA NA  3 NA   0
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-5">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">r = as(m, &quot;realRatingMatrix&quot;) ## store the matrix in sparse format
## The realRatingMatrix can be coerced back into a matrix which is identical to the original matrix
identical(as(r, &quot;matrix&quot;),m)
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

  </div>
</section>
<section class="slide sscode-nowrap compact" id="slide-6">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">## a list of users
as(r, &quot;list&quot;)
</code></pre>

<pre><code>## $u1
## i4 i9 
##  3  1 
## 
## $u2
##  i8 i10 
##   3   4 
## 
## $u3
##  i1  i2  i5  i6  i7  i8 i10 
##   3   3   4   0   3   4   4 
## 
## $u4
## i1 i5 i7 
##  1  5  1 
## 
## $u5
##  i8 i10 
##   3   0
</code></pre>

  </div>
</section>
<section class="slide sscode-nowrap compact" id="slide-7">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">## rating data in data.frame format
head(as(r, &quot;data.frame&quot;))
</code></pre>

<pre><code>##    user item rating
## 4    u1   i4      3
## 13   u1   i9      1
## 10   u2   i8      3
## 14   u2  i10      4
## 1    u3   i1      3
## 3    u3   i2      3
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-8">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">## normalization: remove rating bias by subtracting the row mean from all ratings in the row
r_m = normalize(r)
r_m
</code></pre>

<pre><code>## 5 x 10 rating matrix of class &#39;realRatingMatrix&#39; with 16 ratings.
## Normalized using center on rows.
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-9">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">r_z = normalize(r,method=&quot;Z-score&quot;)
r_z
</code></pre>

<pre><code>## 5 x 10 rating matrix of class &#39;realRatingMatrix&#39; with 16 ratings.
## Normalized using z-score on rows.
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-10">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">## visualize the matrices
image(r, main = &quot;Raw Ratings&quot;)
</code></pre>

<p><img src="assets/fig/class11-chunk-9-1.png" alt="plot of chunk class11-chunk-9"></p>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-11">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">image(r_m, main = &quot;Normalized Ratings&quot;)
</code></pre>

<p><img src="assets/fig/class11-chunk-10-1.png" alt="plot of chunk class11-chunk-10"></p>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-12">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">image(r_z, main = &quot;Normalized Ratings (Z-score)&quot;)
</code></pre>

<p><img src="assets/fig/class11-chunk-11-1.png" alt="plot of chunk class11-chunk-11"></p>

  </div>
</section>
<section class="slide sscode-nowrap compact" id="slide-13">
  <div>
    <h2>Data manipulation</h2>
    <pre><code class="r">## Binarization: transform the real-valued matrix into a 0-1 matrix based on a user specified threshold (min_ratings)
r_b = binarize(r, minRating=4)
as(r_b, &quot;matrix&quot;)
</code></pre>

<pre><code>##       i1    i2    i3    i4    i5    i6    i7    i8    i9   i10
## u1 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## u2 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
## u3 FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE  TRUE
## u4 FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE
## u5 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="sample">
  <div>
    <h2>Sample dataset</h2>
    <pre><code class="r">## load the Jester5k data: it contains a sample of 5000 users from the anonymous ratings data from the Jester Online Joke Recommender System collected between April 1999 and May 2003 (Goldberg, Roeder, Gupta, and Perkins, 2001).

data(Jester5k)
Jester5k
</code></pre>

<pre><code>## 5000 x 100 rating matrix of class &#39;realRatingMatrix&#39; with 362106 ratings.
</code></pre>

  </div>
</section>
<section class="slide sscode-nowrap compact" id="slide-15">
  <div>
    <h2>Sample dataset</h2>
    <pre><code class="r">set.seed(1) ## reset random seed before sampling

## use only a subset of the data containing a sample of 1000 users
r = sample(Jester5k, 1000)

## the ratings for the first user
rowCounts(r[1,])
</code></pre>

<pre><code>## u175 
##   38
</code></pre>

<pre><code class="r">as(r[1,], &quot;list&quot;)
</code></pre>

<pre><code>## $u175
##    j5    j7    j8   j10   j13   j15   j16   j17   j18   j19   j20   j21 
## -4.32  3.45  4.37  5.73 -9.76  2.77  2.48 -0.10  0.58  1.12  5.58  5.49 
##   j27   j28   j29   j32   j33   j35   j36   j47   j48   j49   j50   j53 
##  3.98  4.76  3.16  2.72 -6.50  3.64  1.17  3.40  3.16  8.69  0.58  1.99 
##   j54   j56   j59   j60   j61   j62   j65   j66   j68   j69   j74   j77 
##  7.72  7.14  0.05  7.82  3.59  6.84  3.35 -8.06  7.43 -0.68  2.91  1.70 
##   j81   j95 
## -3.06  7.14
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-16">
  <div>
    <h2>Sample dataset</h2>
    <pre><code class="r">rowMeans(r[1,]) ## The user has rated 100 jokes, the list shows the ratings and the user&#39;s rating average is 1.4731
</code></pre>

<pre><code>## Error in rowMeans(r[1, ]): &#39;x&#39; must be an array of at least two dimensions
</code></pre>

<pre><code class="r">rowMeans(as(r[1,], &quot;matrix&quot;))
</code></pre>

<pre><code>## u175 
##   NA
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-17">
  <div>
    <h2>Sample dataset</h2>
    <pre><code class="r">## generate a histogram to show the distribution of the ratings
hist(getRatings(r), breaks=100)
</code></pre>

<p><img src="assets/fig/class11-chunk-16-1.png" alt="plot of chunk class11-chunk-16"></p>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-18">
  <div>
    <h2>Sample dataset</h2>
    <pre><code class="r">## the distribution after normalization
hist(getRatings(normalize(r)), breaks=100)
</code></pre>

<p><img src="assets/fig/class11-chunk-17-1.png" alt="plot of chunk class11-chunk-17"></p>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-19">
  <div>
    <h2>Sample dataset</h2>
    <pre><code class="r">hist(getRatings(normalize(r, method=&quot;Z-score&quot;)), breaks=100)
</code></pre>

<p><img src="assets/fig/class11-chunk-18-1.png" alt="plot of chunk class11-chunk-18"></p>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-20">
  <div>
    <h2>Sample dataset</h2>
    <pre><code class="r">## how many jokes each user has rated
hist(rowCounts(r), breaks=50)
</code></pre>

<p><img src="assets/fig/class11-chunk-19-1.png" alt="plot of chunk class11-chunk-19"></p>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-21">
  <div>
    <h2>Sample dataset</h2>
    <pre><code class="r">## the mean rating for each joke
hist(colMeans(r), breaks=20)
</code></pre>

<pre><code>## Error in colMeans(r): &#39;x&#39; must be an array of at least two dimensions
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="recommender">
  <div>
    <h2>Recommender System</h2>
    <pre><code class="r">## (training) create a recommender which generates recommendations solely on the popularity of items (the number of users who have the item in their profile)
r = Recommender(Jester5k[1:1000], method = &quot;POPULAR&quot;)
r
</code></pre>

<pre><code>## Recommender of type &#39;POPULAR&#39; for &#39;realRatingMatrix&#39; 
## learned using 1000 users.
</code></pre>

<pre><code class="r">## get the model by getModel()
names(getModel(r))
</code></pre>

<pre><code>## [1] &quot;topN&quot;                  &quot;ratings&quot;               &quot;normalize&quot;            
## [4] &quot;aggregationRatings&quot;    &quot;aggregationPopularity&quot; &quot;verbose&quot;
</code></pre>

  </div>
</section>
<section class="slide sscode-nowrap compact" id="slide-23">
  <div>
    <h2>Recommender System</h2>
    <pre><code class="r">getModel(r)$topN
</code></pre>

<pre><code>## Recommendations as &#39;topNList&#39; with n = 100 for 1 users.
</code></pre>

<pre><code class="r">## (prediction) create top-5 recommendation lists for two users who were not used to learn the model
recom = predict(r, Jester5k[1001:1002], n=5)
recom
</code></pre>

<pre><code>## Recommendations as &#39;topNList&#39; with n = 5 for 2 users.
</code></pre>

<pre><code class="r">as(recom, &quot;list&quot;)
</code></pre>

<pre><code>## $u20089
## [1] &quot;j89&quot; &quot;j72&quot; &quot;j47&quot; &quot;j93&quot; &quot;j76&quot;
## 
## $u11691
## [1] &quot;j89&quot; &quot;j93&quot; &quot;j76&quot; &quot;j88&quot; &quot;j96&quot;
</code></pre>

  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-24">
  <div>
    <h2>Recommender System</h2>
    
  </div>
</section>
<section class="slide scode-nowrap compact" id="slide-25">
  <div>
    <h2>Recommender System</h2>
    
  </div>
</section>
  <div class="progress">
    <div></div>
  </div>
    <footer class = 'foot'>
      <a href="index.html"><img src = 'assets/img/arrow_up_circle.png' style="width:30px;height:30px;"></a></img>
      <a href="#toc"><img src = 'assets/img/circle-info.png' style="width:32px;height:32px;"></a></img>
    </footer>    
	<script src="libraries/frameworks/shower/shower.js"></script>
	<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
	<script type="text/x-mathjax-config">
	  MathJax.Hub.Config({
	    tex2jax: {
	      inlineMath: [['$','$'], ['\\(','\\)']],
	      processEscapes: true
	    }
	  });
	</script>
	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	<!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script> -->
	<script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
	<script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	<!-- DONE LOADING HIGHLIGHTER JS FILES -->
	 
		<!-- Copyright © 2010–2012 Vadim Makeev — pepelsbey.net -->
	<!-- Photos by John Carey — fiftyfootshadows.net -->
</body>
</html>